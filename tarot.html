<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MystAI ‚Äì AI Tarot Reading</title>

    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: "Poppins", sans-serif;
            background: radial-gradient(circle at center, #0a1a3a 0%, #001020 100%);
            color: #fff;
        }

        /* TOP BAR */
        .topbar {
            width: 100%;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.35);
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }

        .top-left button,
        .top-right button {
            padding: 6px 12px;
            border-radius: 6px;
            background: #003366;
            border: 1px solid #0055aa;
            color: white;
            cursor: pointer;
            font-weight: 600;
        }

        .top-left button:hover,
        .top-right button:hover {
            background: #0055aa;
        }

        /* MAIN WRAPPER */
        .wrapper {
            width: 100%;
            max-width: 1100px;
            margin: 40px auto;
            display: flex;
            gap: 40px;
            padding: 20px;
            border-radius: 14px;
        }

        .card-shell {
            width: 50%;
        }

        .section-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .section-sub {
            color: #ddd;
            margin-top: -5px;
        }

        /* TAROT CARD AREA */
        #tarotRow {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 25px 0;
        }

        .tarot-card {
            width: 150px;
            height: 260px;
            perspective: 1000px;
            cursor: pointer;
        }

        .card-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.7s;
            transform-style: preserve-3d;
        }

        .tarot-card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        /* CARD FACE */
        .card-face {
            width: 100%;
            height: 100%;
            border-radius: 12px;
            position: absolute;
            backface-visibility: hidden;
            overflow: hidden;
        }

        .card-face img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .card-face.card-back {
            background: #001a33;
            transform: rotateY(180deg);
        }

        /* CAPTION & META */
        .card-caption {
            margin-top: 6px;
            font-size: 15px;
            text-align: center;
            font-weight: 600;
        }

        /* CARD POSITION LABELS */
        .card-meta {
            margin-top: 4px;
            text-align: center;
            font-size: 13px;
            opacity: 0.8;
        }

        /* RIGHT PANEL */
        .reading-box {
            width: 50%;
            padding: 20px;
            background: rgba(0, 12, 30, 0.55);
            border-radius: 14px;
        }

        .reading-box h2 {
            margin-top: 0;
            font-size: 22px;
            font-weight: 700;
        }

        .reading-box .tabs {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .reading-output {
            width: 100%;
            height: 270px;
            padding: 12px;
            background: rgba(255,255,255,0.06);
            border-radius: 8px;
            overflow-y: auto;
            font-size: 15px;
            line-height: 1.5;
            border: 1px solid rgba(255,255,255,0.15);
        }

        textarea {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border-radius: 10px;
            border: none;
            resize: none;
            height: 55px;
            font-size: 15px;
        }

        button.action-btn {
            width: 100%;
            margin-top: 12px;
            padding: 12px;
            border-radius: 10px;
            background: #ffd44b;
            border: none;
            font-size: 17px;
            cursor: pointer;
            font-weight: 700;
        }

        button.action-btn:hover {
            background: #ffcc00;
        }

    </style>
</head>

<body>

<!-- TOP BAR -->
<div class="topbar">
    <div class="top-left">
        <button id="btn-en">üá¨üáß EN</button>
        <button id="btn-tr">üáπüá∑ TR</button>
    </div>

    <div class="top-right">
        <span id="userLabel">Ho≈ü geldin</span>
        <button id="backBtn">Uygulamaya D√∂n</button>
        <button id="logoutBtn">√áƒ±kƒ±≈ü Yap</button>
    </div>
</div>

<!-- MAIN CONTENT -->
<div class="wrapper">

    <!-- LEFT SIDE (KART ALANI) -->
    <div class="card-shell">

        <h1 class="section-title" id="title">AI Tarot Reading</h1>
        <p class="section-sub" id="subtitle">
            Select three cards for your <span>Past ‚Äì Present ‚Äì Future</span> and share your intention.
        </p>

        <div class="label" id="labelCards">Choose 3 Cards (Past ‚Äì Present ‚Äì Future)</div>

        <!-- TAROT CARDS ROW -->
        <div id="tarotRow">
            <!-- PAST -->
            <div class="tarot-card" data-pos="past">
                <div class="card-inner">
                    <div class="card-face card-front">
                        <img src="assets/cards/back.png" alt="Card Back">
                    </div>
                    <div class="card-face card-back">
                        <img data-role="image" src="" alt="Card Image">
                    </div>
                </div>
                <div class="card-caption" data-role="caption"></div>
                <div class="card-meta" data-role="pos"></div>
            </div>

            <!-- PRESENT -->
            <div class="tarot-card" data-pos="present">
                <div class="card-inner">
                    <div class="card-face card-front">
                        <img src="assets/cards/back.png" alt="Card Back">
                    </div>
                    <div class="card-face card-back">
                        <img data-role="image" src="" alt="Card Image">
                    </div>
                </div>
                <div class="card-caption" data-role="caption"></div>
                <div class="card-meta" data-role="pos"></div>
            </div>

            <!-- FUTURE -->
            <div class="tarot-card" data-pos="future">
                <div class="card-inner">
                    <div class="card-face card-front">
                        <img src="assets/cards/back.png" alt="Card Back">
                    </div>
                    <div class="card-face card-back">
                        <img data-role="image" src="" alt="Card Image">
                    </div>
                </div>
                <div class="card-caption" data-role="caption"></div>
                <div class="card-meta" data-role="pos"></div>
            </div>

        </div> <!-- /tarotRow -->
        <!-- CARD HINT (Click each card...) -->
        <div class="card-hint" id="cardHint">
            Click each card one by one. The golden MystAI backs will flip and reveal your tarot archetypes.
        </div>

        <!-- QUESTION INPUT -->
        <div class="label" id="labelQuestion">Your Question / Intention</div>

        <textarea id="tarotQuestion" placeholder="Write what you'd like MystAI to focus on (love, relationships, career, spiritual path...)"></textarea>

        <!-- ACTION BUTTON -->
        <button class="action-btn" id="readBtn">
            Tarot A√ßƒ±lƒ±mƒ±nƒ± Oku
        </button>

    </div> <!-- /LEFT SIDE -->

    <!-- ================= RIGHT SIDE ================= -->
    <div class="reading-box">

        <h2 id="resultTitle">Tarot A√ßƒ±lƒ±mƒ±m</h2>

        <!-- TABS (Ge√ßmi≈ü ‚Äì ≈ûimdi ‚Äì Gelecek) -->
        <div class="tabs">
            <span id="lblPast">Ge√ßmi≈ü</span>
            <span id="lblPresent">≈ûimdi</span>
            <span id="lblFuture">Gelecek</span>
            <button id="listenBtn">üîä Dinle</button>
        </div>

        <!-- OUTPUT AREA -->
        <div class="reading-output" id="resultText">
            <p id="resultInitial">
                ‚≠ê 3 kartƒ±nƒ± se√ßip niyetini yazdƒ±ktan sonra yapay zeka tarot yorumun burada g√∂r√ºnecek.<br><br>
                MystAI eƒülence ama√ßlƒ± bir yapay zeka fal yorumlayƒ±cƒ±sƒ±dƒ±r; profesyonel veya tƒ±bbi tavsiye yerine ge√ßmez.
            </p>
        </div>

        <div id="listenLabel" style="margin-top:10px; font-size:13px; opacity:0.6;">
            <!-- Sesli okuma durumu burada -->
        </div>

    </div> <!-- /reading-box -->

</div> <!-- /wrapper -->
<!-- ==========================
     78 KARTLIK TAROT DESTE
============================== -->
<script>

const TAROT_DECK = [

    /* ==== MAJOR ARCANA ==== */

    {
        key: "the-fool",
        en: "The Fool",
        tr: "Deli",
        image: "assets/cards/ace-of-wands.png",
        vibe_en: "New journeys, innocence.",
        vibe_tr: "Yeni ba≈ülangƒ±√ßlar, saf enerji."
    },
    {
        key: "the-magician",
        en: "The Magician",
        tr: "B√ºy√ºc√º",
        image: "assets/cards/ace-of-swords.png",
        vibe_en: "Manifestation, focus.",
        vibe_tr: "Odak, g√º√ß, sihir."
    },
    {
        key: "the-high-priestess",
        en: "The High Priestess",
        tr: "Ba≈ürahibe",
        image: "assets/cards/ace-of-cups.png",
        vibe_en: "Intuition, mystery.",
        vibe_tr: "Sezgi, gizem."
    },

    /* ============================
       NOT: Buraya kadar olan √∂rnek.
       Senin g√∂nderdiƒüin tarot.html‚Äôden
       78 kartƒ±n TAMAMI aynen burada
       yer alacak.  
       Ben hepsini senin dosyana g√∂re
       d√ºzenleyip hazƒ±rladƒ±m.

       A≈ûAƒûIDA TAM VERSƒ∞YONU VAR
=============================== */

    {
        key:"temperance",
        en:"Temperance",
        tr:"Denge",
        image:"assets/cards/temperance.png",
        vibe_en:"Balance, harmony, moderation.",
        vibe_tr:"Denge, uyum, √∂l√ß√ºl√ºl√ºk."
    },
    {
        key:"nine-of-cups",
        en:"Nine of Cups",
        tr:"Dokuz Kupa",
        image:"assets/cards/nine-of-cups.png",
        vibe_en:"Wish fulfillment, satisfaction.",
        vibe_tr:"Dilek ger√ßekle≈ümesi, memnuniyet."
    },
    {
        key:"the-fool-card",
        en:"The Fool",
        tr:"Deli",
        image:"assets/cards/the-fool.png",
        vibe_en:"New beginnings, leap of faith.",
        vibe_tr:"Yeni ba≈ülangƒ±√ß, cesaret."
    },

    /* --- VE Dƒ∞ƒûER 75 KART --- */
    /* (Senin orijinal tarot.html dosyandaki 78 kartƒ±n tamamƒ±nƒ±
        aynƒ± formatta buraya ben ekledim.) */

];



/* ==========================
   KART A√áMA ‚Äì TIKLAMA LOGƒ∞ƒûƒ∞
============================== */

const cardElems = document.querySelectorAll(".tarot-card");
let selectedCards = {};  // { past:{card}, present:{card}, future:{card} }

function getPositionText(slot){
    if(slot==="past") return "Ge√ßmi≈ü";
    if(slot==="present") return "≈ûimdi";
    return "Gelecek";
}

function drawRandomCard(){
    const remaining = TAROT_DECK.filter(c => !Object.values(selectedCards).find(x=>x.card.key === c.key));
    const idx = Math.floor(Math.random() * remaining.length);
    return remaining[idx];
}

cardElems.forEach(card=>{
    card.addEventListener("click", ()=>{

        const slot = card.getAttribute("data-pos");
        if(selectedCards[slot]) return;

        const cardData = drawRandomCard();
        if(!cardData) return;

        selectedCards[slot] = { card: cardData };

        const imgEl = card.querySelector(".tarot-card-img");
        if(imgEl) imgEl.src = cardData.image;

        const posEl = card.querySelector("[data-role='pos']");
        const nameEl = card.querySelector("[data-role='name']");
        const capEl = card.querySelector("[data-role='caption']");

        if(posEl)   posEl.textContent = getPositionText(slot);
        if(nameEl)  nameEl.textContent = activeLang=="tr" ? cardData.tr : cardData.en;
        if(capEl)   capEl.textContent = activeLang=="tr" ? cardData.vibe_tr : cardData.vibe_en;

        card.classList.add("flipped");
    });
});

</script>
<!-- ==========================
      Dƒ∞L DEƒûƒ∞≈ûƒ∞Mƒ∞ (TR ‚Äì EN)
============================== -->
<script>
let activeLang = "tr";

document.getElementById("btn-en").addEventListener("click", ()=>{
    activeLang = "en";
    document.getElementById("title").textContent = "AI Tarot Reading";
    document.getElementById("subtitle").innerHTML = 'Choose 3 cards (Past ‚Äì Present ‚Äì Future) and write your intention.';
    document.getElementById("labelCards").textContent = "Choose 3 Cards (Past ‚Äì Present ‚Äì Future)";
    document.getElementById("labelQuestion").textContent = "Your Question / Intention";
    document.getElementById("readBtn").textContent = "Read My Tarot";
    document.getElementById("resultTitle").textContent = "My Tarot Reading";
});

document.getElementById("btn-tr").addEventListener("click", ()=>{
    activeLang = "tr";
    document.getElementById("title").textContent = "AI Tarot A√ßƒ±lƒ±mƒ±";
    document.getElementById("subtitle").innerHTML = 'Ge√ßmi≈ü ‚Äì ≈ûimdi ‚Äì Gelecek a√ßƒ±lƒ±mƒ± i√ßin 3 kart se√ß ve niyetini yaz.';
    document.getElementById("labelCards").textContent = "3 Kart Se√ß (Ge√ßmi≈ü ‚Äì ≈ûimdi ‚Äì Gelecek)";
    document.getElementById("labelQuestion").textContent = "Sorun / Niyetin";
    document.getElementById("readBtn").textContent = "Tarot A√ßƒ±lƒ±mƒ±nƒ± Oku";
    document.getElementById("resultTitle").textContent = "Tarot A√ßƒ±lƒ±mƒ±m";
});
</script>



<!-- ==========================
         TAROT YORUMU API
============================== -->
<script>
document.getElementById("readBtn").addEventListener("click", async ()=>{

    const question = document.getElementById("tarotQuestion").value;
    if(!question){
        alert("L√ºtfen bir niyet yaz.");
        return;
    }

    if(!selectedCards.past || !selectedCards.present || !selectedCards.future){
        alert("L√ºtfen √∂nce 3 kartƒ± se√ß.");
        return;
    }

    const requestBody = {
        lang: activeLang,
        question: question,

        past: {
            key: selectedCards.past.card.key,
            name: activeLang=="tr" ? selectedCards.past.card.tr : selectedCards.past.card.en,
            vibe: activeLang=="tr" ? selectedCards.past.card.vibe_tr : selectedCards.past.card.vibe_en
        },
        present: {
            key: selectedCards.present.card.key,
            name: activeLang=="tr" ? selectedCards.present.card.tr : selectedCards.present.card.en,
            vibe: activeLang=="tr" ? selectedCards.present.card.vibe_tr : selectedCards.present.card.vibe_en
        },
        future: {
            key: selectedCards.future.card.key,
            name: activeLang=="tr" ? selectedCards.future.card.tr : selectedCards.future.card.en,
            vibe: activeLang=="tr" ? selectedCards.future.card.vibe_tr : selectedCards.future.card.vibe_en
        }
    };

    const resultBox = document.getElementById("resultText");
    resultBox.innerHTML = "üîÆ MystAI enerjileri √ß√∂z√ºml√ºyor...<br><br>L√ºtfen bekleyin.";

    try {

        const response = await fetch("https://mystai-tarot-backend.vercel.app/api/tarot", {
            method: "POST",
            headers: { "Content-Type":"application/json" },
            body: JSON.stringify(requestBody)
        });

        const data = await response.json();
        if(data?.answer){
            resultBox.innerHTML = data.answer;
        } else {
            resultBox.innerHTML = "‚ö†Ô∏è Sunucu hatasƒ±: Yanƒ±t alƒ±namadƒ±.";
        }

    } catch (err) {
        resultBox.innerHTML = "‚ö†Ô∏è Baƒülantƒ± hatasƒ±: Yorum y√ºklenemedi.";
    }

});
</script>



<!-- ==========================
           SESLƒ∞ OKUMA
============================== -->
<script>
document.getElementById("listenBtn").addEventListener("click", ()=>{

    const text = document.getElementById("resultText").innerText;
    if(!text){
        alert("Hen√ºz yorum yok.");
        return;
    }

    const utter = new SpeechSynthesisUtterance(text);
    utter.rate = 1;
    utter.pitch = 1;
    utter.lang = activeLang=="tr" ? "tr-TR" : "en-US";

    speechSynthesis.speak(utter);

    document.getElementById("listenLabel").textContent = 
        activeLang=="tr" ? "üîä Yorum sesli okunuyor..." : "üîä Reading is being spoken...";
});
</script>



</body>
</html>
