<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MystAI.ai ‚Äî Your Digital Fortune Portal</title>
  <link rel="icon" type="image/png" href="mystai-logo.png" />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&display=swap" rel="stylesheet">

  <style>
    :root { --bg-start:#0d1440; --bg-end:#0b0f1f; --text:#d8e0ff; --muted:#a9b4d0; --accent:#f2c84b; }
    html,body{
      margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      color:var(--text);text-align:center;overflow-x:hidden;
      background:radial-gradient(1400px 800px at 50% -10%, #101a4d 0%, #0b0f1f 85%);
    }

    header{
      position:relative;
      padding:16px 40px;display:flex;justify-content:space-between;align-items:center;
      background:rgba(10,15,30,0.35);backdrop-filter:blur(12px);
      border-bottom:1px solid rgba(255,255,255,0.06);z-index:1000;
    }

    .lang-box,.nav-btns{display:flex;gap:10px;align-items:center;}
    .lang-btn{
      font-weight:700;border:0;border-radius:50px;padding:7px 13px;cursor:pointer;font-size:13px;
      background:linear-gradient(135deg,#ffd54f,#ffe680);color:#111;transition:all .3s ease;
    }
    .lang-btn.secondary{background:rgba(255,255,255,.1);color:#e6ecff;border:1px solid rgba(255,255,255,.12)}
    .btn{
      font-weight:700;border:0;border-radius:10px;padding:8px 18px;cursor:pointer;
      color:#0b0f1f;background:#ffd54f;font-size:14px;transition:all .3s ease;
    }
    .btn:hover,.lang-btn:hover{filter:brightness(1.1);transform:translateY(-2px)}

    /* Logo */
    .floating-logo{
      position:absolute;left:50%;top:90px;transform:translateX(-50%);
      height:170px;width:auto;pointer-events:none;
      animation:float 6s ease-in-out infinite alternate, glow 6s ease-in-out infinite alternate;
      filter:drop-shadow(0 0 35px rgba(255,230,150,.65)) brightness(1.05);
      z-index:5;
    }
    @keyframes float{from{transform:translate(-50%,-12px)}to{transform:translate(-50%,8px)}}
    @keyframes glow{from{filter:drop-shadow(0 0 25px rgba(255,240,180,.4))}to{filter:drop-shadow(0 0 55px rgba(255,250,200,.8))}}

    /* Hero */
    .hero{text-align:center;padding-top:280px;padding-bottom:50px}
    .hero h1{color:#f5d76e;font-size:46px;margin-bottom:12px;text-shadow:0 0 14px rgba(255,220,120,.3);font-family:'Cinzel',serif}
    .hero p{color:var(--text);max-width:720px;margin:0 auto;font-size:18px;line-height:1.6}
    .welcome{font-weight:600;color:#ffe680;text-shadow:0 0 10px rgba(255,220,120,.4);margin-right:12px}

    /* Grid ‚Äî 5 kart yan yana (desktop) */
    .grid{
    .grid {
    display:grid;
  gap:28px;
  padding:60px 20px;
  max-width:1400px;
  margin:auto;
  grid-template-columns:repeat(5, 260px);
  justify-content:center;
}

    }
    @media (max-width:1100px){
      .grid{
        grid-template-columns: repeat(5, 240px);

      }
    }

    .tile{
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.06);
      border-radius:14px;
      padding:14px;
      transition:transform .3s ease,box-shadow .3s ease;
    }
    .tile:hover{transform:scale(1.02);box-shadow:0 0 30px rgba(255,215,0,.2)}
    .reading-img{
      width:100%;height:320px;object-fit:cover;
      border-radius:14px;margin-bottom:14px;
      box-shadow:0 0 18px rgba(255,215,0,.18)
    }
    .tile h3{color:#f5d76e;font-family:'Cinzel',serif;margin-bottom:10px}
    .tile p{color:var(--muted);font-size:15px;min-height:60px}
    .start-btn{
      background:linear-gradient(120deg,#ffd700,#ffcc33,#ffe680);
      font-weight:700;color:#111;border:none;
      padding:10px 20px;border-radius:10px;cursor:pointer;
      transition:transform .3s ease;
      box-shadow:0 0 15px rgba(255,215,0,.4)
    }
    .start-btn:hover{transform:scale(1.08)}

    /* Footer */
    footer{margin-top:80px;padding:36px 0;border-top:1px solid rgba(255,255,255,.08);color:#aeb6cf;font-size:14px}
    footer a{color:#cfe4ff;text-decoration:none}
    footer a:hover{color:#ffe680}
    .links{margin-bottom:8px}

    /* Ask MystAI Button (bottom-right) */
    .ask-fab{
      position:fixed; right:18px; bottom:18px; z-index:1200;
      background:linear-gradient(135deg,#ffd54f,#ffe680);
      color:#111; border:none; border-radius:999px; padding:12px 18px;
      font-weight:800; box-shadow:0 8px 30px rgba(0,0,0,.35);
      cursor:pointer; display:flex; align-items:center; gap:8px;
    }
    .ask-fab:hover{filter:brightness(1.06); transform:translateY(-2px)}

    /* Ask MystAI Modal */
    .ask-modal{
      position:fixed;inset:0;background:rgba(0,0,0,.65);
      display:none;justify-content:center;align-items:center;z-index:1300;
    }
    .ask-card{
      width:min(720px,92vw); background:#0d1a2b; border:1px solid rgba(255,255,255,.12);
      border-radius:16px; padding:20px;
      box-shadow:0 0 40px rgba(255,215,0,.35)
    }
    .ask-title{margin:0 0 10px; color:#ffd54f; font-family:'Cinzel',serif}
    .ask-row{display:flex; gap:12px; margin-top:10px}
    .ask-row textarea{
      flex:1; height:110px; resize:vertical; border-radius:10px; border:1px solid rgba(255,255,255,.15);
      background:#0b132a; color:#e6ecff; padding:10px; font-family:inherit; font-size:15px;
    }
    .ask-actions{display:flex; gap:10px; justify-content:flex-end; margin-top:10px}
    .ask-btn{background:#ffd54f;color:#111;border:none;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
    .ask-secondary{background:transparent; color:#e6ecff; border:1px solid rgba(255,255,255,.2)}
    .ask-output{
      margin-top:14px; background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.06); padding:12px;
      border-radius:10px; display:none; text-align:left; white-space:pre-wrap
    }
    .ask-hint{color:#a9b4d0; font-size:12px; margin-top:6px}
    .spinner{display:none; margin-left:6px}

    @media(max-width:768px){
      .floating-logo{height:120px;top:100px}
      .hero{padding-top:220px}
    }
  </style>
</head>
<body>

  <header>
    <div class="lang-box">
      <button class="lang-btn" id="btn-en">EN</button>
      <button class="lang-btn secondary" id="btn-tr">TR</button>
    </div>

    <div class="nav-btns">
      <span id="user-welcome" class="welcome"></span>
      <button class="btn" id="historyBtn" data-i18n="history">My History</button>
      <button class="btn" id="logoutBtn" data-i18n="logout">Logout</button>
    </div>
  </header>

  <img src="mystai-logo.png" alt="MystAI Logo" class="floating-logo">

  <section class="hero">
    <h1 data-i18n="choose">Choose Your Reading</h1>
    <p data-i18n="desc">
      Explore the ancient art of divination through the power of AI.<br>
      Select your path below to begin your mystical journey.
    </p>
  </section>

  <!-- 5 KART -->
  <section class="grid">
    <article class="tile" data-type="coffee">
      <img src="images/Coffee.png" class="reading-img" alt="Coffee Reading">
      <h3 data-i18n="coffeeTitle">AI Coffee Reading</h3>
      <p data-i18n="coffeeDesc">
        Upload your cup image and receive symbolic and emotional insights decoded by AI.
      </p>
      <button class="start-btn" data-i18n="start">Start Reading</button>
    </article>

    <article class="tile" data-type="tarot">
      <img src="images/Tarot.png" class="reading-img" alt="Tarot Reading">
      <h3 data-i18n="tarotTitle">AI Tarot Reading</h3>
      <p data-i18n="tarotDesc">
        Draw cards digitally and let AI interpret archetypes and guidance for you.
      </p>
      <button class="start-btn" data-i18n="start">Start Reading</button>
    </article>

    <article class="tile" data-type="palm">
      <img src="images/Palm.png" class="reading-img" alt="Palm Reading">
      <h3 data-i18n="palmTitle">AI Palm Reading</h3>
      <p data-i18n="palmDesc">
        Scan your palm and discover patterns and meanings through AI analysis.
      </p>
      <button class="start-btn" data-i18n="start">Start Reading</button>
    </article>

    <article class="tile" data-type="energy">
      <img src="images/Energy.png" class="reading-img" alt="Energy & Dreams">
      <h3 data-i18n="energyTitle">Energy & Dreams</h3>
      <p data-i18n="energyDesc">
        Upload your dreams or energy symbols and receive reflective AI interpretations.
      </p>
      <button class="start-btn" data-i18n="start">Start Reading</button>
    </article>

    <!-- YENƒ∞ 5. KART: ASTROLOJƒ∞ -->
    <article class="tile" data-type="astrology">
      <img src="images/Astrology.png" class="reading-img" alt="Astrology & Birth Chart">
      <h3 data-i18n="astroTitle">Astrology & Birth Chart</h3>
      <p data-i18n="astroDesc">
        Discover your personal birth chart and explore AI-generated zodiac and planet insights.
      </p>
      <button class="start-btn" data-i18n="start">Start Reading</button>
    </article>
  </section>

  <footer>
    <div class="links">
      <a href="terms.html" data-i18n="terms">Terms</a> ‚Ä¢ 
      <a href="privacy.html" data-i18n="privacy">Privacy</a> ‚Ä¢ 
      <a href="cookies.html" data-i18n="cookies">Cookies</a> ‚Ä¢ 
      <a href="disclaimer.html" data-i18n="disclaimer">Disclaimer</a>
    </div>
    <p>
      ¬© 2025 MystAI.ai ‚Äî <span data-i18n="rights">All Rights Reserved.</span> 
      <span data-i18n="dev">Developed by GALAXY üåå</span><br>
      <a href="mailto:support@mystai.ai">support@mystai.ai</a>
    </p>
  </footer>

  <!-- Ask MystAI FAB (AYNEN ESKƒ∞ Gƒ∞Bƒ∞) -->
  <button class="ask-fab" id="askFab">
    üîÆ <span data-i18n="ask">Ask MystAI</span>
  </button>

  <!-- Ask MystAI Modal -->
  <div class="ask-modal" id="askModal" role="dialog" aria-modal="true" aria-labelledby="askTitle">
    <div class="ask-card">
      <h2 class="ask-title" id="askTitle" data-i18n="askTitle">Ask MystAI üîÆ</h2>
      <div class="ask-row">
        <textarea id="askInput" placeholder="Type your question..."></textarea>
      </div>
      <div class="ask-hint" id="askHint">
        Tip: You can ask about your energy, dreams, love, career, or destiny.
      </div>
      <div class="ask-actions">
        <button class="ask-btn ask-secondary" id="askClose" data-i18n="close">Close</button>
        <button class="ask-btn" id="askSend">
          <span data-i18n="send">Send</span>
          <span class="spinner" id="askSpin">‚è≥</span>
        </button>
      </div>
      <div class="ask-output" id="askOutput"></div>
      <audio id="askAudio" style="display:none;"></audio>
    </div>
  </div>

  <script type="module">
    /* ====== CONFIG ====== */
    const BACKEND_URL = "https://mystai-international-1.onrender.com";

    /* ====== Firebase (sadece auth i√ßin) ====== */
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDyiD7GAfOjMbtm-S6pO6XCSRXJclffPL0",
      authDomain: "mystai-6cca2.firebaseapp.com",
      projectId: "mystai-6cca2",
      storageBucket: "mystai-6cca2.appspot.com",
      messagingSenderId: "624127781219",
      appId: "1:624127781219:web:a580ac6e80ccc26e694b56"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    /* ====== UI Elemanlarƒ± ====== */
    const logoutBtn   = document.getElementById('logoutBtn');
    const historyBtn  = document.getElementById('historyBtn');
    const userWelcome = document.getElementById('user-welcome');

    /* ====== i18n ====== */
    const i18n = {
      en: {
        choose:"Choose Your Reading",
        desc:"Explore the ancient art of divination through the power of AI.<br>Select your path below to begin your mystical journey.",
        coffeeTitle:"AI Coffee Reading",
        coffeeDesc:"Upload your cup image and receive symbolic and emotional insights decoded by AI.",
        tarotTitle:"AI Tarot Reading",
        tarotDesc:"Draw cards digitally and let AI interpret archetypes and guidance for you.",
        palmTitle:"AI Palm Reading",
        palmDesc:"Scan your palm and discover patterns and meanings through AI analysis.",
        energyTitle:"Energy & Dreams",
        energyDesc:"Upload your dreams or energy symbols and receive reflective AI interpretations.",
        astroTitle:"AI Astrology Reading",
        astroDesc:"Discover your personal birth chart, zodiac energies and AI-generated interpretations.",
        start:"Start Reading",
        logout:"Logout",
        history:"My History",
        terms:"Terms", privacy:"Privacy", cookies:"Cookies", disclaimer:"Disclaimer",
        rights:"All Rights Reserved.", dev:"Developed by GALAXY üåå",
        ask:"Ask MystAI",
        askTitle:"Ask MystAI üîÆ",
        send:"Send",
        close:"Close",
        hint:"Tip: You can ask about your energy, dreams, love, career, or destiny.",
        placeholder:"Type your question..."
      },
      tr: {
        choose:"Falƒ±nƒ± Se√ß",
        desc:"Yapay zek√¢ g√ºc√ºyle kadim fal sanatƒ±nƒ± ke≈üfet.<br>A≈üaƒüƒ±dan yolunu se√ß ve mistik yolculuƒüuna ba≈üla.",
        coffeeTitle:"Yapay Zek√¢ Kahve Falƒ±",
        coffeeDesc:"Fincan fotoƒürafƒ±nƒ± y√ºkle; sembolik ve duygusal i√ßg√∂r√ºler yapay zek√¢ tarafƒ±ndan √ß√∂z√ºmlensin.",
        tarotTitle:"Yapay Zek√¢ Tarot A√ßƒ±lƒ±mƒ±",
        tarotDesc:"Kartlarƒ±nƒ± dijital olarak se√ß; arketipler ve rehberlik yapay zek√¢ tarafƒ±ndan yorumlansƒ±n.",
        palmTitle:"Yapay Zek√¢ El Falƒ±",
        palmDesc:"Avucunu tara; √ßizgi ve desenleri yapay zek√¢ analiz etsin.",
        energyTitle:"Enerji & R√ºyalar",
        energyDesc:"R√ºyalarƒ±nƒ± veya enerji sembollerini y√ºkle; AI bunlarƒ± farkƒ±ndalƒ±kla yorumlasƒ±n.",
        astroTitle:"Astroloji & Doƒüum Haritasƒ±",
        astroDesc:"AI yorumlu doƒüum haritanƒ±, yƒ±ldƒ±znameni ve gezegen etkilerini ke≈üfet.",
        start:"Falƒ±nƒ± Ba≈ülat",
        logout:"√áƒ±kƒ±≈ü Yap",
        history:"Ge√ßmi≈üim",
        terms:"≈ûartlar", privacy:"Gizlilik", cookies:"√áerezler", disclaimer:"Sorumluluk Reddi",
        rights:"T√ºm Haklarƒ± Saklƒ±dƒ±r.", dev:"GALAXY tarafƒ±ndan geli≈ütirilmi≈ütir üåå",
        ask:"MystAI'ye Sor",
        askTitle:"MystAI'ye Sor üîÆ",
        send:"G√∂nder",
        close:"Kapat",
        hint:"ƒ∞pucu: Enerji, r√ºyalar, a≈ük, kariyer ya da kaderin hakkƒ±nda sorular sorabilirsin.",
        placeholder:"Sorunu yaz..."
      }
    };

    let activeLang = localStorage.getItem("myst_lang") || "en";

    function setLang(lang){
      activeLang = lang;
      localStorage.setItem("myst_lang", lang);
      const dict = i18n[lang];

      document.querySelectorAll("[data-i18n]").forEach(el=>{
        const key = el.getAttribute("data-i18n");
        if(key==="desc"){ el.innerHTML = dict[key]; }
        else { el.textContent = dict[key]; }
      });

      document.getElementById("askInput").placeholder = dict.placeholder;
      document.getElementById("askHint").textContent = dict.hint;

      document.getElementById("btn-en").classList.toggle("secondary", lang!=="en");
      document.getElementById("btn-tr").classList.toggle("secondary", lang!=="tr");

      if(auth.currentUser){
        const name = auth.currentUser.displayName || auth.currentUser.email;
        userWelcome.textContent = (lang === 'tr' ? 'Ho≈ü geldin, ' : 'Welcome, ') + name;
      }
    }

    document.getElementById("btn-en").addEventListener("click",()=>setLang("en"));
    document.getElementById("btn-tr").addEventListener("click",()=>setLang("tr"));
    setLang(activeLang);

    /* ====== Auth / Nav ====== */
    logoutBtn.addEventListener('click', ()=> {
      signOut(auth).then(()=>window.location.href = "login.html");
    });

    historyBtn.addEventListener('click', ()=>window.location.href="history.html");

    onAuthStateChanged(auth, (user)=>{
      if(user){
        const name = user.displayName || user.email;
        userWelcome.textContent = (activeLang === 'tr' ? 'Ho≈ü geldin, ' : 'Welcome, ') + name;
      } else {
        window.location.href = "login.html";
      }
    });

    /* ====== Start Reading y√∂nlendirme ====== */
    document.querySelectorAll('.tile').forEach(tile=>{
      const btn  = tile.querySelector('.start-btn');
      const type = tile.dataset.type; // coffee, tarot, palm, energy, astrology

      let target = 'app.html';
      if(type === 'coffee')    target = 'coffee.html';
      else if(type === 'tarot')     target = 'tarot.html';
      else if(type === 'palm')      target = 'palm.html';
      else if(type === 'energy')    target = 'energy.html';
      else if(type === 'astrology') target = 'astrology.html';

      btn.addEventListener('click', ()=>{ window.location.href = target; });
    });

    /* ====== Ask MystAI ====== */
    const askFab    = document.getElementById('askFab');
    const askModal  = document.getElementById('askModal');
    const askClose  = document.getElementById('askClose');
    const askSend   = document.getElementById('askSend');
    const askInput  = document.getElementById('askInput');
    const askOutput = document.getElementById('askOutput');
    const askSpin   = document.getElementById('askSpin');
    const askAudio  = document.getElementById('askAudio');

    askFab.addEventListener('click', ()=> {
      askModal.style.display='flex';
      askInput.focus();
    });

    askClose.addEventListener('click', ()=> {
      askModal.style.display='none';
      askOutput.style.display='none';
      askInput.value='';
      askAudio.pause(); askAudio.currentTime=0; askAudio.src='';
    });

    askModal.addEventListener('click', (e)=>{
      if(e.target === askModal){ askClose.click(); }
    });

    askSend.addEventListener('click', async ()=>{
      const q = askInput.value.trim();
      if(!q){
        alert(activeLang==='tr' ? 'L√ºtfen bir soru yazƒ±n.' : 'Please type a question.');
        return;
      }

      askSpin.style.display='inline-block';
      askSend.disabled = true;
      askOutput.style.display='none';
      askOutput.textContent = '';

      try{
        if(!BACKEND_URL){
          askOutput.style.display='block';
          askOutput.textContent = activeLang==='tr'
            ? 'Backend adresi yapƒ±landƒ±rƒ±lmadƒ±.'
            : 'Backend URL is not configured.';
          return;
        }

        const res = await fetch(`${BACKEND_URL}/predict`, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ user_input: q })
        });

        if(!res.ok){
          throw new Error((activeLang==='tr'?'ƒ∞stek ba≈üarƒ±sƒ±z: ':'Request failed: ')+res.status);
        }

        const data = await res.json();
        const text = data?.text || (activeLang==='tr'?'Yanƒ±t alƒ±namadƒ±.':'No response.');
        const audioPath = data?.audio;

        askOutput.style.display='block';
        askOutput.textContent = text;

        if(audioPath){
          const audioURL = audioPath.startsWith('http') ? audioPath : `${BACKEND_URL}${audioPath}`;
          askAudio.src = audioURL;
          askAudio.play().catch(()=>{});
        }
      }catch(err){
        askOutput.style.display='block';
        askOutput.textContent = (activeLang==='tr'?'Hata: ':'Error: ') + (err?.message||err);
      }finally{
        askSpin.style.display='none';
        askSend.disabled = false;
      }
    });
  </script>
</body>
</html>
